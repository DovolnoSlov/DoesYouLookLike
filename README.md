# DoesYouLookLike
Who do you look like from celebrities


Чат-бот для телеграм, который по фотографии, с применением логистической регрессии, делает предсказание схожести со звездой голливуда!

В проект входит:
- загрузка изображений знаменитостей из поисковика Bing
- обработка изображений, создание данных на их основе
- обучение модели логистической регресси (запускается вручную)
- сохранение модели после обучения в файл, для многократного использования 
- реализация чат-бота, который использует полученную модель для предсказаний на основе изображения пользователя
- конфигурационный файл, который позволяет варьировать некоторые параметры

Описание файлов проекта:

	notebook\DoesYouLookLike_JN.ipynb - файл с первоначальным кодом на получение и обработку изображений, данных и самой модели, с последующим предсказанием на тестовом изображении.

	preprocessing:
		load_images.py:
				download_images - загрузка изображений из Bing по запросу, сохранение в каталоге data\train_images
				rename_dir - изменение имени каталогов с изображениями, сформированного по тексту запроса
				count_files_in_dir - подсчёт количества файлов в каталогах с условием <2 -> True 
				reformat_image - изменение размерности изображений, по списку имён, с помощью resize_image
				resize_image - изменение размерности изображения (х1), поступающего на вход
		create_data.py:
				class GetEmbedding - класс для получения эмбеддингов и таргетов после обработки изображений
				
				get_save_embedding - главный метод класса, который получает данные из скрытых методов класса, и сохраняет результаты в каталоге data\model_data


	model:
		model_train.py:
			class ModelImgLR: - класс для создания и обучения модели, с сохранением модели в каталоге data\model_data
				+проверка ключа KEY_LOAD_TRAIN_IMAGES из config_model.yaml для оценки необходимости загрузки тренировочных изображений
		model_predict.py:
		 	class PredictModelImgLR - класс для предсказания по модели на основе изображения пользователя. 
		 		predict_model - главный метод класса, который получает данные из скрытых методов класса, и выдаёт результат предсказания

	trial_iteration\trial_iteration.py - пробная итерация предсказания по готовой обученной модели. Тест по своей сути

Порядок работы:
- запустить файл app.py (бот получает токен через load_dotenv(), из файла, который не сохранён в проекте, но должен быть в папке bot)
- работать с ботом через телеграм
- в случае необходимости переподготовки модели - запустить model_train.py, и обратить внимание на ключ key_load_train_images в конфиг-файле, т.к. тренировочные изображения в сам проект не перенесены.
- !также реализован запуск через "docker-compose up" 

Дополнительная информация по последним обновлениям:
- в код включено логгирование, которое позволяет отслеживать работу чат-бота в онлайн-режиме
- не самая лучшая оптимизация в данный момент - модель и эмбеддинги изображений каждый раз заново загружаются при работе с пользователем
- requirements.txt для виртуального окружения - в проекте представлен Только для Dockerfile, в связи с проблематичной установкой библиотек cmake, dlib, face_recognition напрямую в виртуальное окружение проекта. Вместо него представлен NOrequirements.txt, с перечнем используемых сторонних библиотек
- замечена проблема взаимодействия бота с пользователями, у которых не указан username телеграма в настройках аккаунта